import store from '@/store';
import { RevisionStatus }  from '@/store/constants/revisionStatus'

class BlockRevision {
  constructor({ api }) {
    this.api = api;
  }

  render() {
    return {
      icon: `
      <div class="flex justify-start items-start flex-grow-0 flex-shrink-0 relative gap-2.5 p-2.5 rounded-lg border border-[#f2f2f2]">
        <svg
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
          class="flex-grow-0 flex-shrink-0 w-6 h-6 relative"
          preserveAspectRatio="none">
          <path
            d="M6.91024 22.9933C6.98233 23.0022 7.05521 23.0022 7.1273 22.9933L10.9341 22.328C11.0946 22.2888 11.2416 22.2053 11.3592 22.0866L22.474 10.639C22.8109 10.2911 23 9.82045 23 9.32989C23 8.83933 22.8109 8.36871 22.474 8.0208L21.0451 6.54459C20.8771 6.37195 20.6776 6.23499 20.4581 6.14154C20.2385 6.0481 20.0031 6 19.7654 6C19.5277 6 19.2923 6.0481 19.0728 6.14154C18.8532 6.23499 18.6537 6.37195 18.4857 6.54459L7.37087 17.955C7.25401 18.0763 7.16986 18.2267 7.12668 18.3914L6.03299 21.842C6.00049 21.9622 5.99189 22.0878 6.0077 22.2114C6.02351 22.335 6.06341 22.4541 6.12503 22.5615C6.18664 22.669 6.2687 22.7626 6.36632 22.8368C6.46393 22.9109 6.5751 22.9642 6.69319 22.9933C6.76528 23.0022 6.83816 23.0022 6.91024 22.9933ZM19.7609 7.85368L21.1988 9.32989L19.7609 10.8061L18.332 9.32989L19.7609 7.85368ZM8.82692 19.0877L17.0477 10.639L18.4857 12.1152L10.2558 20.5639L8.3476 21.0467L8.82692 19.0877Z"
            fill="#727272">
          </path>
          <path
            d="M7.41667 22C5.60196 22 4.54314 21.9912 3.33333 20.9286C0.24833 18.2187 2.96874 11.1823 6.13279 11.5533C8.99102 11.8884 8.66407 15.4442 5.5 16C3.45563 16.3591 0.999792 16.4493 1 13.0044C1.00007 11.9169 1.6143 9.22336 4.83508 7"
            stroke="#727272"
            stroke-width="1.6"
            stroke-linecap="round"
            stroke-linejoin="round"
            class="block-revision-icon-path">
          </path>
          <path
            d="M12.3567 8.5621L12.2334 8.84479C12.1432 9.05174 11.8568 9.05174 11.7666 8.84479L11.6433 8.5621C11.4236 8.05806 11.0278 7.65675 10.5339 7.4372L10.154 7.26837C9.94866 7.17707 9.94866 6.87837 10.154 6.78708L10.5126 6.62768C11.0192 6.40249 11.4221 5.98632 11.6381 5.46516L11.7647 5.15968C11.8529 4.94677 12.1471 4.94677 12.2353 5.15968L12.3619 5.46516C12.5779 5.98632 12.9808 6.40249 13.4874 6.62768L13.846 6.78708C14.0513 6.87837 14.0513 7.17707 13.846 7.26837L13.4662 7.4372C12.9723 7.65675 12.5765 8.05806 12.3567 8.5621Z"
            fill="#727272">
          </path>
          <path
            d="M8.53506 6.34315L8.35011 6.76718C8.21481 7.07761 7.78521 7.07761 7.64984 6.76718L7.46496 6.34315C7.13534 5.58709 6.54164 4.98512 5.80079 4.65581L5.23102 4.40255C4.92299 4.26561 4.92299 3.81756 5.23102 3.68062L5.76892 3.44152C6.52881 3.10373 7.13316 2.47949 7.45709 1.69774L7.64699 1.23952C7.77936 0.920161 8.22066 0.920161 8.35296 1.23952L8.54286 1.69774C8.86686 2.47949 9.4712 3.10373 10.2311 3.44152L10.7689 3.68062C11.077 3.81756 11.077 4.26561 10.7689 4.40255L10.1992 4.65581C9.45838 4.98512 8.86468 5.58709 8.53506 6.34315Z"
            fill="#727272">
            </path>
        </svg>
      </div>`,
      label: this.api.i18n.t('Block revision'),
      onActivate: () => {
        const index = this.api.blocks.getCurrentBlockIndex();
        const block = this.api.blocks.getBlockByIndex(index);
        const text = block.holder.innerText;
        store.commit('SET_BLOCK_REVISION_TEXT', text)
        store.commit('SET_BLOCK_REVISION_INDEX', index)
        store.commit('SET_REVISION_STATE', RevisionStatus.BLOCK_LLM_REQUESTED)
      }
    };
  }

  static get isTune() {
    return true;
  }
}

export default BlockRevision;